{% extends 'pingapp/base.html' %}

{% load staticfiles %}

{% block title %}Ping Panel{% endblock %}

{% block head_css %}
  <link href='{% static 'pingapp/css/pingpanel.css' %}' rel='stylesheet' type='text/css'>
{% endblock %}

{% block content %}
  <div id="intro" class="row">
    <div class="column medium-10">
      <h3>Hey, {{ user.username }}!</h3>
    </div>
    <div class="column medium-2">
      <a class="tiny button expand" href="{% url 'logout' %}">log out</a>
    </div>
  </div>

  <div class="row">
    <div class="column medium-8">
      <div>
        <span>Recent Pings</span>
      </div>
    </div>
    <div class="column medium-4">
      <div class="marginbox">
        <a class="tiny button expand">add friends</a>
        <div class="borderbox">
          <div>
            <form id="searchuserform" action="{% url 'searchusers' %}">
              {% csrf_token %}
              <div class="row collapse">
                <div class="column small-8">
                  {{ usernameform.username }}
                </div>
                <div class="column small-4">
                  <input id="searchusersbutton" type="submit" value="search" class="tiny button postfix"></input>
                </div>
              </div>
            </form>
            <div id="makerequestlist" class="userlist" data-add-friend-request-ajax-url="{% url 'sendfriendrequest' %}" data-csrf-token="{{ csrf_token }}">

            </div>
          </div>
        </div>
      </div>

      <div class="marginbox">
        <a class="tiny button expand">pending requests</a>
        <div class="borderbox">
          <div id="requests">
            {% for request in user.requests.all %}
              <a class="tiny button expand userbutton" data-dropdown="pendingrequestdrop-id-{{ request.id }}"><i class="fa fa-fw fa-caret-down"></i> {{ request.username }}</a>
              <ul id="pendingrequestdrop-id-{{ request.id }}" class="tiny f-dropdown" data-dropdown-content>
                <li><a class="acceptrequest" data-user-id="{{ request.id }}"><i class="fa fa-fw fa-check"></i> accept</a></li>
                <li><a class="declinerequest" data-user-id="{{ request.id }}"><i class="fa fa-fw fa-times"></i> decline</a></li>
              </ul>  
            {% endfor %}
          </div>
        </div>
      </div>

      <div class="marginbox">
        <a class="tiny button expand">my friends</a>
        <div class="borderbox">
          <div id="friends">
            {% for friend in user.friends.all %}
              <a class="tiny button expand userbutton" data-dropdown="frienddrop-id-{{ request.id }}"><i class="fa fa-fw fa-user"></i> {{ friend.username }}</a>
              <ul id="frienddrop-id-{{ request.id }}" class="tiny f-dropdown" data-dropdown-content>
                <li><a class="pingfriend" data-user-id="{{ request.id }}"><i class="fa fa-fw fa-map-marker"></i> ping</a></li>
                <li><a class="removefriend" data-user-id="{{ request.id }}"><i class="fa fa-fw fa-exclamation"></i> remove friend</a></li>
              </ul>  
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
  </div>
{% endblock %}

{% block body_js %}
  <script src="{% static 'pingapp/js/searchusers.js' %}"></script>
{% endblock %}